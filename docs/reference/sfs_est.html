<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate SFS using algorithm of Li (2011) — sfs_est • updog</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate SFS using algorithm of Li (2011) — sfs_est"><meta name="description" content="We use the dynamic algorithm of Section 2.3.5 to obtain the site allele
frequency likelihood for all SNPs, then use the EM algorithm of Section
2.3.8 to estimate the site frequency spectrum."><meta property="og:description" content="We use the dynamic algorithm of Section 2.3.5 to obtain the site allele
frequency likelihood for all SNPs, then use the EM algorithm of Section
2.3.8 to estimate the site frequency spectrum."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">updog</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/multidog.html">Genotyping Many SNPs with multidog()</a></li>
    <li><a class="dropdown-item" href="../articles/oracle_calculations.html">Oracle Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/simulate_ngs.html">Simulate Next-Generation Sequencing Data</a></li>
    <li><a class="dropdown-item" href="../articles/smells_like_updog.html">Example Use of Updog</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcgerard/updog/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate SFS using algorithm of Li (2011)</h1>
      <small class="dont-index">Source: <a href="https://github.com/dcgerard/updog/blob/HEAD/R/sfs.R" class="external-link"><code>R/sfs.R</code></a></small>
      <div class="d-none name"><code>sfs_est.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>We use the dynamic algorithm of Section 2.3.5 to obtain the site allele
frequency likelihood for all SNPs, then use the EM algorithm of Section
2.3.8 to estimate the site frequency spectrum.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sfs_est</span><span class="op">(</span><span class="va">glarray</span>, tol <span class="op">=</span> <span class="fl">1e-05</span>, itermax <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-glarray">glarray<a class="anchor" aria-label="anchor" href="#arg-glarray"></a></dt>
<dd><p>An array of genotype log-likelihoods. Rows index SNPs,
columns index individuals, slices index genotypes</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>The stopping tolerance for the EM algorithm</p></dd>


<dt id="arg-itermax">itermax<a class="anchor" aria-label="anchor" href="#arg-itermax"></a></dt>
<dd><p>The maximum number of EM iterations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The estimated SFS.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Li, H. (2011). A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data. Bioinformatics, 27(21), 2987-2993.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Gerard</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"uitdewilligen"</span>, package <span class="op">=</span> <span class="st">"updog"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mout</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidog.html">multidog</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  refmat <span class="op">=</span> <span class="va">uitdewilligen</span><span class="op">$</span><span class="va">refmat</span>,</span></span>
<span class="r-in"><span>  sizemat <span class="op">=</span> <span class="va">uitdewilligen</span><span class="op">$</span><span class="va">sizemat</span>,</span></span>
<span class="r-in"><span>  ploidy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     |                                   *.#,%    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||                                 *******/  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  |||||||    (**..#**.                  */   **/  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |||||||||    */****************************/*%   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||    &amp;****..,*.************************/    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||     (....,,,*,...****%********/(******    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||                ,,****%////,,,,./.****/    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||                  /**//         .*///....  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||                  .*/*/%#         .,/   ., </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||               , **/   #%         .*    .. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    |||                               ,,,*        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working on it...done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimate SFS using genotype likelihoods</span></span></span>
<span class="r-in"><span><span class="va">glarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="format_multidog.html">format_multidog</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mout</span>, varname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"logL_"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sfs_gl</span> <span class="op">&lt;-</span> <span class="fu">sfs_est</span><span class="op">(</span><span class="va">glarray</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## compare to SFS using posterior modes</span></span></span>
<span class="r-in"><span><span class="va">genomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="format_multidog.html">format_multidog</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mout</span>, varname <span class="op">=</span> <span class="st">"geno"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sfs_mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">genomat</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        levels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genomat</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## pretty similar, some differences:</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="va">sfs_mode</span>, gl <span class="op">=</span> <span class="va">sfs_gl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">mode</span> <span class="op">&gt;</span> <span class="fl">1e-6</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">gl</span> <span class="op">&gt;</span> <span class="fl">1e-6</span>, <span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mode    gl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 236  0.1 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 237  0.0 0.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 251  0.1 0.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 257  0.1 0.144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 259  0.1 0.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 261  0.2 0.189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 265  0.1 0.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 266  0.0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 271  0.1 0.202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 272  0.1 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 277  0.1 0.100</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Gerard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

